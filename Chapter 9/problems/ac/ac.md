# 多子串搜索与AC自动机

### ★ 问题描述

多子串搜索问题就是要在主串中搜索多个子串出现的位置。确切地说，如果待搜索的多个字符串组成的集合为 $P=\left\{p_1[0:m_1],p_2[0:m_2],\cdots,p_k[0:m_k]\right\}$ ， $m=\sum_{i=1}^k m_i$ ，主串为 $t[0:n-1]$ ，多子串搜索问题就是找出 $P$ 中字符串在 $t$ 中出现的位置。
如果对 $P$ 中每个字符串 $p_i$ 用一次 KMP 算法找出其在 $t$ 中出现的位置, 则完成多子串搜索任务需要的计算时间为 $O(kn+m)$ 。当 $P$ 中字符串个数较多时，这个算法的效率就太低了。Aho-Corasick 多子串搜索算法，又称为 AC 自动机，能在 $O(n+m+z)$ 时间内完成多子串搜索任务, 其中 $z$ 是 $P$ 中字符串在 $t$ 中出现的次数。

### ★ 算法设计

给定 $n$ 个由小写英文字符组成的不同的字符串 $p_1,p_2,\cdots,p_n$，以及一个主字符串 $t$，用AC 自动机算法，计算字符串 $p_1,p_2,\cdots,p_n$ 在主字符串 $t$ 中出现的次数。

### ★ 数据输入

输入文件名为ac.in。

每个文件有多组测试数据。每组测试数据的第一行有1个正整数 $n$，表示有 $n​$ 个字符串。接下来的 $n$ 行，每行给出一个字符串。最后一行给出主字符串。

其中数据满足：$1\leq n\leq 10$。

### ★ 结果输出

输出文件名为ac.out。

每行依次输出每组测试数据所对应字符串在主字符串中出现的次数。

**输入示例**  

```
3
a
aa
abc
aabcdcbaaab
3
a
aa
abc
bcdefghijk
```

**输出示例**  

```
9
0
```


